C UTEP Electronic Structure Lab (2020)
C
C *****************************************************************
C 
      SUBROUTINE LDACOR(RHO,XI,ISET,EC,VC)
       IMPLICIT REAL*8  (A-H,O-Z)
C
C      ISET=1 CEPERLEY-ALDER, 2 CEPERLEY, 3 RPA
C      ISET=4 WIGNER,ISET=5 GUNARSSON LUNDQVIST
C
C        JOE'S VERSION OF CORRELATION PROGRAM
C
      DIMENSION A(2,3),B(2,3),C(2,3),D(2,3),GAM(2,3),BETA1(2,3),
     *          BETA2(2,3),VC(2)
      SAVE
      DATA A/0.0311,0.01555,0.0311,0.01555,0.0311,0.01555/,
     *     B/-0.048,-0.0269,-0.048,-0.0269,-0.071,-0.0499/,
     *     C/0.0020,0.0007,0.0014,0.0001,0.0021,0.0005/,
     *     D/-0.0116,-0.0048,-0.0108,-0.0046,-0.0078,-0.0020/,
     *   GAM/-0.1423,-0.0843,-0.1471,-0.0790,-0.2044,-0.1104/,
     * BETA1/1.0529,1.3981,1.1581,1.2520,1.5023,1.1102/,
     * BETA2/0.3334,0.2611,0.3446,0.2567,0.0916,0.0170/
      DATA CU,CP/-0.0333,-0.0203/
      DATA CONST/-3.847322/,DENOM/0.5198421/
      DATA FOURPI/12.56637061435917295D0/
      DATA ONED3/0.33333333333333333D0/
      DATA GAMMA,THDPITHRD/0.297,0.98474502184269654D0/
      EC=0.0D0
      IF(RHO .LT. 1.0D-15)GO TO 400
       GO TO(300,300,300,500,600)ISET
300   RS=1.0D0/(1.611991953D0*RHO**ONED3)
      APLUS= 1.0D0+XI
      AMINUS=1.0D0-XI
      TEST=1.0D0-RS
      IF(TEST) 10,10,20
10    DNMU=1.0D0+BETA1(1,ISET)*SQRT(RS)+BETA2(1,ISET)*RS
      DNMP=1.0D0+BETA1(2,ISET)*SQRT(RS)+BETA2(2,ISET)*RS
      ECU=GAM(1,ISET)/DNMU
      ECP=GAM(2,ISET)/DNMP
      VCU=ECU/DNMU*(1.0D0+7.0D0/6.0D0*BETA1(1,ISET)*SQRT(RS)
     &    +4.0D0/3.0D0*BETA2(1,ISET)*RS)
      VCP=ECP/DNMP*(1.0D0+7.0D0/6.0D0*BETA1(2,ISET)*SQRT(RS)
     &    +4.0D0/3.0D0*BETA2(2,ISET)*RS)
      GO TO 30
20    ECU=(A(1,ISET)+C(1,ISET)*RS)*LOG(RS)+B(1,ISET)+D(1,ISET)*RS
      ECP=(A(2,ISET)+C(2,ISET)*RS)*LOG(RS)+B(2,ISET)+D(2,ISET)*RS
      VCU=(A(1,ISET)+2.0D0/3.0D0*C(1,ISET)*RS)*LOG(RS)
     &    +B(1,ISET)-A(1,ISET)/3.0D0
     &    +(2*D(1,ISET)-C(1,ISET))*RS/3.0D0
      VCP=(A(2,ISET)+2.0D0/3.0D0*C(2,ISET)*RS)*LOG(RS)
     &    +B(2,ISET)-A(2,ISET)/3.0D0
     &    +(2*D(2,ISET)-C(2,ISET))*RS/3.0D0
30    F=CONST+(APLUS*CBRT(APLUS)+AMINUS*CBRT(AMINUS))/DENOM
      EC=ECU+F*(ECP-ECU)
      DERIV=4.0D0/3.0D0*(CBRT(APLUS)-CBRT(AMINUS))/DENOM
      VC(1)=VCU+F*(VCP-VCU)+DERIV*(ECP-ECU)*AMINUS
      VC(2)=VCU+F*(VCP-VCU)-DERIV*(ECP-ECU)*APLUS
      RETURN
 400   CONTINUE
       VC(1)=0.0D0
       VC(2)=0.0D0
 500   CONTINUE
C      WIGNER FORM
       EC=CBRT(RHO)
       VC(1)=-0.945D0-8.91D0*EC
       VC(1)=VC(1)*EC
       VC(2)=1.0D0+FOURPI*EC
       EC=-0.709D0*EC/VC(2)
       VC(1)=VC(1)/VC(2)**2
       VC(2)=VC(1)
       RETURN
 600   CONTINUE
C      GUNNARSSON-LUNDQVIST
       RS=1.0D0/(1.611991953D0*RHO**ONED3)
       APLUS=1.0D0+XI
       AMINUS=1.0D0-XI
       F=CONST+(APLUS*CBRT(APLUS)+AMINUS*CBRT(AMINUS))/DENOM
       XU=RS/11.4D0
       XP=RS/15.9D0
       ECU=CU*((1.0D0+XU*XU*XU)*LOG(1.0D0+1.0D0/XU)
     &    +0.5D0*XU-XU*XU-ONED3)
       ECP=CP*((1.0D0+XP*XP*XP)*LOG(1.0D0
     &    +1.0D0/XP)+0.5D0*XP-XP*XP-ONED3)
       EC=ECU+F*(ECP-ECU)
       BET=1.0D0+0.0545D0*RS*LOG(1.0D0+1.0D0/XU)
       DEL=1.0D0-0.036D0*RS+1.36D0*RS/(1.0D0+10.0D0*RS)
C
C MUPX CHANGED TO AMUPX (POREZAG FEB 1995)
C
       AMUPX=-THDPITHRD*CBRT(RHO)
       VC(1)=-CBRT(1.0D0+XI)+BET+ONED3*DEL*XI/(1.0D0+GAMMA*XI)
       VC(2)=-CBRT(1.0D0-XI)+BET-ONED3*DEL*XI/(1.0D0-GAMMA*XI)
       VC(1)=AMUPX*VC(1)
       VC(2)=AMUPX*VC(2)
       RETURN
      END
